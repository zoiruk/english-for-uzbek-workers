<!DOCTYPE html>
<html lang="uz">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Interactive English textbook for Uzbek seasonal workers in the UK - CEFR A0-A1 level">
    <meta name="keywords" content="English learning, Uzbek, seasonal workers, UK, CEFR A0-A1">
    <meta name="author" content="Zoir UK">
    <title>English for Uzbek Seasonal Workers - Interactive Textbook</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Telegram WebApp Script -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" href="icon-192.png">
    
    <!-- Theme Color -->
    <meta name="theme-color" content="#1976d2">
    <style>
        /* Material Design 3 Base Styles - Performance Optimized */
        :root {
            --md-sys-color-primary: #1976d2;
            --md-sys-color-on-primary: #ffffff;
            --md-sys-color-primary-container: #d3e3fd;
            --md-sys-color-on-primary-container: #001c38;
            --md-sys-color-secondary: #565f71;
            --md-sys-color-on-secondary: #ffffff;
            --md-sys-color-surface: #fefbff;
            --md-sys-color-on-surface: #1a1c1e;
            --md-sys-color-surface-variant: #e1e2ec;
            --md-sys-color-on-surface-variant: #44474f;
            --md-sys-color-outline: #74777f;
            --md-sys-color-shadow: #000000;
            --md-sys-elevation-level1: 0px 1px 3px rgba(0, 0, 0, 0.12), 0px 1px 2px rgba(0, 0, 0, 0.24);
            --md-sys-elevation-level2: 0px 3px 6px rgba(0, 0, 0, 0.16), 0px 3px 6px rgba(0, 0, 0, 0.23);
        }

        /* Performance optimizations */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Use transform3d to enable hardware acceleration */
        .chapter-card,
        .progress-fill,
        .notification {
            transform: translate3d(0, 0, 0);
            backface-visibility: hidden;
        }

        /* Optimize animations for 60fps */
        .chapter-card,
        .progress-fill,
        .exercise-indicator {
            will-change: transform, opacity;
        }

        /* Contain layout and paint for better performance */
        .chapter-card {
            contain: layout style paint;
        }

        .chapters-grid {
            contain: layout;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--md-sys-color-on-surface);
            background-color: var(--md-sys-color-surface);
        }

        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: var(--md-sys-color-primary);
            color: var(--md-sys-color-on-primary);
            padding: 8px 16px;
            text-decoration: none;
            border-radius: 4px;
            z-index: 1000;
            font-weight: 500;
            border: 2px solid transparent;
            min-height: 44px;
            display: flex;
            align-items: center;
        }

        .skip-link:focus {
            top: 6px;
            outline: 3px solid #ffffff;
            outline-offset: 2px;
        }

        /* Enhanced focus indicators for all interactive elements */
        .chapter-card:focus,
        .nav-btn:focus,
        button:focus,
        a:focus,
        input:focus,
        select:focus,
        textarea:focus {
            outline: 3px solid var(--md-sys-color-primary);
            outline-offset: 2px;
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            :root {
                --md-sys-color-primary: #0066cc;
                --md-sys-color-on-primary: #ffffff;
                --md-sys-color-surface: #ffffff;
                --md-sys-color-on-surface: #000000;
                --md-sys-color-outline: #000000;
            }
        }

        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {

            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 16px;
        }

        .header {
            text-align: center;
            margin-bottom: 32px;
            padding: 24px 0;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 400;
            color: var(--md-sys-color-primary);
            margin-bottom: 8px;
        }

        .header .subtitle {
            font-size: 1.25rem;
            color: var(--md-sys-color-on-surface-variant);
            margin-bottom: 16px;
        }



        .chapters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .chapter-card {
            background: var(--md-sys-color-surface);
            border-radius: 16px;
            padding: 24px;
            box-shadow: var(--md-sys-elevation-level1);
            transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
            text-decoration: none;
            color: inherit;
            border: 1px solid var(--md-sys-color-outline);
            min-height: 140px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            position: relative;
            overflow: hidden;
        }

        .chapter-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 6px;
            height: 100%;
            background: var(--chapter-color, var(--md-sys-color-primary));
            transition: width 0.3s ease;
        }

        .chapter-card:hover {
            box-shadow: var(--md-sys-elevation-level2);
            transform: translateY(-4px);
        }

        .chapter-card:hover::before {
            width: 12px;
        }

        .chapter-card:focus {
            outline: 3px solid var(--md-sys-color-primary);
            outline-offset: 2px;
        }

        .chapter-card:active {
            transform: translateY(-2px);
            transition: transform 0.1s ease;
        }

        .chapter-number {
            font-size: 0.875rem;
            font-weight: 500;
            opacity: 0.7;
            margin-bottom: 4px;
        }

        .chapter-title {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .chapter-description {
            font-size: 0.875rem;
            color: var(--md-sys-color-on-surface-variant);
            line-height: 1.4;
        }

        .chapter-progress {
            margin-top: 16px;
            font-size: 0.75rem;
            color: var(--md-sys-color-primary);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .chapter-progress-bar {
            flex: 1;
            height: 4px;
            background: var(--md-sys-color-surface-variant);
            border-radius: 2px;
            overflow: hidden;
        }

        .chapter-progress-fill {
            height: 100%;
            background: var(--chapter-color, var(--md-sys-color-primary));
            transition: width 0.3s ease;
        }

        .chapter-status-icon {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            color: white;
        }

        .chapter-status-icon.completed {
            background: #4caf50;
        }

        .chapter-status-icon.in-progress {
            background: #ff9800;
        }

        .chapter-status-icon.not-started {
            background: var(--md-sys-color-outline);
        }

        .exercise-indicators {
            display: flex;
            gap: 4px;
            margin-top: 12px;
            flex-wrap: wrap;
        }

        .exercise-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            transition: all 0.2s ease;
        }

        .exercise-indicator.completed {
            background: #4caf50;
            box-shadow: 0 0 4px rgba(76, 175, 80, 0.4);
        }

        .exercise-indicator.not-completed {
            background: var(--md-sys-color-outline);
            opacity: 0.5;
        }

        .exercise-indicator:hover {
            transform: scale(1.2);
        }



        .footer {
            text-align: center;
            padding: 32px 0;
            border-top: 1px solid var(--md-sys-color-outline);
            margin-top: 48px;
        }

        .footer p {
            color: var(--md-sys-color-on-surface-variant);
            font-size: 0.875rem;
        }

        /* Mobile Responsive - Enhanced for Touch */
        @media (max-width: 768px) {
            .container {
                padding: 12px;
            }

            .header {
                margin-bottom: 24px;
                padding: 16px 0;
            }

            .header h1 {
                font-size: 1.75rem;
                line-height: 1.2;
            }

            .header .subtitle {
                font-size: 1rem;
                margin-bottom: 12px;
            }

            /* Mobile navigation buttons */
            .header div[style*="margin-top: 24px"] {
                flex-direction: column !important;
                align-items: center !important;
                gap: 8px !important;
            }

            .header div[style*="margin-top: 24px"] a {
                width: 100% !important;
                max-width: 280px !important;
                justify-content: center !important;
                padding: 14px 20px !important;
                font-size: 0.9rem !important;
            }

            .chapters-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .chapter-card {
                padding: 16px;
                min-height: 120px;
                border-radius: 12px;
                touch-action: manipulation;
                -webkit-tap-highlight-color: transparent;
            }

            .chapter-card:active {
                background: var(--md-sys-color-surface-variant);
                transform: scale(0.98);
                transition: transform 0.1s ease;
            }



            .exercise-indicators {
                gap: 3px;
                margin-top: 8px;
            }

            .exercise-indicator {
                width: 6px;
                height: 6px;
            }

            /* Enhanced touch feedback */
            .chapter-card::after {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.04);
                opacity: 0;
                transition: opacity 0.15s ease;
                border-radius: inherit;
                pointer-events: none;
            }

            .chapter-card:active::after {
                opacity: 1;
            }
        }

        /* Extra small mobile devices */
        @media (max-width: 480px) {
            .container {
                padding: 8px;
            }

            .header h1 {
                font-size: 1.5rem;
            }

            .header .subtitle {
                font-size: 0.9rem;
            }

            .chapter-card {
                padding: 12px;
                min-height: 100px;
            }

            .chapter-title {
                font-size: 1rem;
                line-height: 1.3;
            }

            .chapter-description {
                font-size: 0.8rem;
            }


        }

        /* Touch targets for mobile - ensuring 44px minimum */
        @media (max-width: 768px) {

            /* Ensure all interactive elements meet touch target requirements */
            .chapter-card,
            .nav-btn,
            button,
            a,
            input,
            select,
            textarea {
                min-height: 44px;
                min-width: 44px;
            }

            /* Improve button spacing for touch */
            .nav-btn {
                padding: 12px 20px;
                margin: 8px 4px;
            }

            /* Better touch feedback for links */
            a:not(.chapter-card) {
                padding: 8px 12px;
                border-radius: 8px;
                display: inline-block;
                transition: background-color 0.15s ease;
            }

            a:not(.chapter-card):active {
                background-color: rgba(0, 0, 0, 0.08);
            }
        }

        /* Tablet responsive */
        @media (min-width: 769px) and (max-width: 1024px) {
            .chapters-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 18px;
            }
        }

        /* Large desktop */
        @media (min-width: 1200px) {
            .chapters-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 24px;
            }
        }

        /* Screen reader only content */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Keyboard navigation indicators */
        .keyboard-user *:focus {
            outline: 3px solid var(--md-sys-color-primary) !important;
            outline-offset: 2px !important;
        }

        /* Ensure minimum touch target size */
        .chapter-card,
        .nav-btn,
        button,
        a,
        input,
        select,
        textarea {
            min-height: 44px;
            min-width: 44px;
        }

        /* Color contrast improvements */
        .chapter-description {
            color: #424242;
            /* Improved contrast ratio */
        }

        .progress-stat-label {
            color: #424242;
            /* Improved contrast ratio */
        }

        /* Mobile touch states */
        .mobile-device .chapter-card.touch-active {
            background: var(--md-sys-color-surface-variant);
            transform: scale(0.98);
        }

        /* Offline mode styles */
        .offline-mode {
            position: relative;
        }

        .offline-mode::before {
            content: 'Offline Mode - Oflayn rejim';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #ff9800;
            color: white;
            text-align: center;
            padding: 8px;
            font-size: 0.875rem;
            font-weight: 500;
            z-index: 1000;
        }

        .offline-mode .container {
            margin-top: 40px;
        }

        /* High DPI optimizations */
        .high-dpi .exercise-indicator {
            border: 0.5px solid rgba(255, 255, 255, 0.2);
        }

        /* Notification styles */
        .notification {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.4;
        }

        /* Enhanced mobile navigation */
        @media (max-width: 768px) {
            .skip-link {
                font-size: 0.875rem;
                padding: 6px 12px;
            }

            /* Better spacing for mobile */
            .header {
                text-align: center;
            }

            .header>* {
                margin-bottom: 8px;
            }

            /* Improved mobile typography */
            .chapter-number {
                font-size: 0.75rem;
            }

            .chapter-progress {
                margin-top: 12px;
                font-size: 0.7rem;
            }


        }

        /* Landscape mobile optimizations */
        @media (max-width: 768px) and (orientation: landscape) {
            .header {
                margin-bottom: 16px;
                padding: 12px 0;
            }

            .header h1 {
                font-size: 1.5rem;
            }



            .chapters-grid {
                gap: 8px;
            }

            .chapter-card {
                padding: 12px;
                min-height: 80px;
            }
        }

        /* Completion Card Specific Styles */
        .completion-card {
            background: linear-gradient(135deg, #4caf50 0%, #2e7d32 100%);
            color: white;
            border: none;
            position: relative;
            overflow: hidden;
            min-height: 200px;
        }

        .completion-card::before {
            background: rgba(255, 255, 255, 0.1);
            width: 8px;
        }

        .completion-card:hover::before {
            width: 16px;
            background: rgba(255, 255, 255, 0.2);
        }

        .completion-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .completion-header h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 12px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .completion-header p {
            font-size: 0.95rem;
            opacity: 0.95;
            line-height: 1.4;
            margin-bottom: 8px;
        }

        .completion-stats {
            margin-top: 16px;
        }

        .completion-stats h4 {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 16px;
            text-align: center;
            opacity: 0.95;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
            align-items: stretch;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            padding: 12px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 80px;
        }

        .stat-item:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .stat-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.6s ease;
        }

        .stat-item:hover::before {
            left: 100%;
        }

        .stat-number {
            display: block;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 4px;
            color: #ffffff;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .stat-label {
            font-size: 0.75rem;
            opacity: 0.95;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: rgba(255, 255, 255, 0.95);
            text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
        }

        .completion-progress {
            margin-top: 16px;
            position: relative;
        }

        .completion-progress .progress-bar {
            height: 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 8px;
            position: relative;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        .completion-progress .progress-bar::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: progressShimmer 2s infinite;
        }

        @keyframes progressShimmer {
            0% { left: -100%; }
            50% { left: 100%; }
            100% { left: 100%; }
        }

        .completion-progress .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ffeb3b 0%, #ffc107 50%, #ff9800 100%);
            border-radius: 5px;
            transition: width 1.2s cubic-bezier(0.4, 0.0, 0.2, 1);
            box-shadow: 0 0 12px rgba(255, 235, 59, 0.6), inset 0 1px 0 rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        .completion-progress .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.2) 50%, transparent 100%);
            animation: progressGlow 2s ease-in-out infinite alternate;
        }

        @keyframes progressGlow {
            0% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .completion-progress .progress-text {
            font-size: 0.85rem;
            font-weight: 600;
            text-align: center;
            display: block;
            opacity: 0.95;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
            margin-top: 4px;
        }

        /* Future content placeholder */
        .future-content-placeholder {
            margin-top: 16px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            border: 1px dashed rgba(255, 255, 255, 0.3);
            text-align: center;
            font-size: 0.8rem;
            opacity: 0.7;
        }

        /* Mobile responsive adjustments for completion card */
        @media (max-width: 768px) {
            .completion-card {
                min-height: 180px;
                padding: 16px;
            }

            .completion-header h3 {
                font-size: 1.25rem;
            }

            .completion-header p {
                font-size: 0.85rem;
            }

            .stats-grid {
                gap: 8px;
                grid-template-columns: repeat(2, 1fr);
            }

            .stat-item {
                padding: 10px;
                min-height: 70px;
            }

            .stat-number {
                font-size: 1.25rem;
            }

            .stat-label {
                font-size: 0.7rem;
            }
        }

        /* Extra small mobile devices */
        @media (max-width: 480px) {
            .completion-card {
                min-height: 160px;
                padding: 12px;
            }

            .completion-header h3 {
                font-size: 1.1rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                gap: 6px;
            }

            .stat-item {
                padding: 8px;
                min-height: 60px;
            }
        }

        /* High contrast mode support for completion card */
        @media (prefers-contrast: high) {
            .completion-card {
                background: #2e7d32;
                border: 3px solid #ffffff;
            }

            .stat-item {
                background: rgba(255, 255, 255, 0.95);
                color: #000000;
                border: 2px solid #000000;
            }

            .stat-item .stat-number,
            .stat-item .stat-label {
                color: #000000;
            }

            .completion-progress .progress-bar {
                background: #ffffff;
                border: 1px solid #000000;
            }

            .completion-progress .progress-fill {
                background: #000000;
                box-shadow: none;
            }

            .completion-progress .progress-text {
                color: #ffffff;
                text-shadow: 1px 1px 0 #000000;
            }
        }

        /* Progress update animations */
        .completion-summary {
            transition: all 0.3s ease;
        }

        .chapter-progress-fill {
            transition: width 0.8s cubic-bezier(0.4, 0.0, 0.2, 1), box-shadow 0.3s ease;
        }

        .chapter-status-icon {
            transition: all 0.3s ease;
        }

        .chapter-status-icon.completed {
            animation: celebrationPulse 1s ease-in-out;
        }

        @keyframes celebrationPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        /* Reduced motion support for completion card */
        @media (prefers-reduced-motion: reduce) {
            .completion-progress .progress-fill {
                transition: none;
            }

            .completion-progress .progress-fill::after {
                animation: none;
            }

            .completion-progress .progress-bar::before {
                animation: none;
            }

            .stat-item {
                transition: none;
            }

            .stat-item::before {
                transition: none;
            }

            .completion-card:hover {
                transform: none;
            }

            .stat-item:hover {
                transform: none;
            }

            .completion-summary {
                transition: none;
            }

            .chapter-progress-fill {
                transition: none;
            }

            .chapter-status-icon {
                transition: none;
            }

            .chapter-status-icon.completed {
                animation: none;
            }
        }
    </style>
</head>

<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <a href="#chapters-grid" class="skip-link">Skip to chapters</a>

    <div class="container" id="main-content">
        <header class="header" role="banner">
            <h1>English for Uzbek Seasonal Workers</h1>
            <p class="subtitle">Interactive English Textbook - CEFR A0-A1 Level</p>
            <p lang="uz">Xush kelibsiz! Ushbu interaktiv darslik Buyuk Britaniyaga Seasonal Worker Visa dasturi orqali
                keluvchi o'zbek mavsumiy ishchilari uchun ZoirUK tomonidan maxsus yaratilgan. Darslik A0 (mutlaq
                boshlang'ich) dan A1 (boshlang'ich) darajasigacha ingliz tilini o'rganishga yordam beradi.</p>

            <div style="margin-top: 24px; display: flex; flex-wrap: wrap; gap: 12px; justify-content: center;">
                <a href="course-info.html" style="display: inline-flex; align-items: center; gap: 8px; padding: 12px 20px; 
                          background: var(--md-sys-color-secondary); color: var(--md-sys-color-on-secondary); 
                          text-decoration: none; border-radius: 20px; font-weight: 500; 
                          transition: all 0.2s ease; box-shadow: var(--md-sys-elevation-level1);
                          min-height: 44px;"
                    onmouseover="this.style.boxShadow='var(--md-sys-elevation-level2)'; this.style.transform='translateY(-2px)'"
                    onmouseout="this.style.boxShadow='var(--md-sys-elevation-level1)'; this.style.transform='translateY(0)'"
                    aria-label="Course information and certificate details">
                    <span aria-hidden="true">ℹ️</span> Course Info / Kurs Haqida
                </a>
            </div>
        </header>


        <main class="chapters-grid" id="chapters-grid" role="main" aria-label="Course chapters">
            <h2 class="sr-only">Course Chapters</h2>
            <!-- Chapters will be populated by JavaScript -->
        </main>

        <footer class="footer" role="contentinfo">
            <div style="margin-bottom: 20px; display: flex; flex-wrap: wrap; justify-content: center; gap: 16px;">
                <a href="https://t.me/ZoirUK" target="_blank" rel="noopener noreferrer"
                    style="color: var(--md-sys-color-primary); text-decoration: none; font-weight: 500; padding: 8px 12px; border-radius: 8px; transition: background-color 0.2s ease; min-height: 44px; display: flex; align-items: center; gap: 6px;"
                    onmouseover="this.style.backgroundColor='var(--md-sys-color-primary-container)'"
                    onmouseout="this.style.backgroundColor='transparent'"
                    aria-label="Contact us on Telegram">
                    <span aria-hidden="true">📞</span> Contact Us / Biz bilan bog'laning
                </a>
            </div>
            <p lang="uz">&copy; 2025 Zoir UK. Barcha huquqlar himoyalangan.</p>
            <p>English for Uzbek Seasonal Workers - Interactive Learning Platform</p>
        </footer>

        <!-- ARIA Live Region for Screen Reader Announcements -->
        <div id="aria-live-region" class="sr-only" aria-live="polite" aria-atomic="true"></div>
        <div id="aria-live-assertive" class="sr-only" aria-live="assertive" aria-atomic="true"></div>
    </div>

    <script src="progress-tracker.js" onerror="console.error('Failed to load progress-tracker.js')" onload="console.log('progress-tracker.js loaded successfully')"></script>
    <script>
        // Chapter data with M3 color scheme
        // 
        // EXTENSION POINT: A2 Level Chapters
        // To add A2 level chapters, extend this array with chapters 26-35:
        // 
        // A2 Level Structure (Future Implementation):
        // { id: 26, title: "Advanced Workplace Communication", description: "Murakkab ish joyidagi muloqot", file: "Chapter_26_Advanced_Workplace.html", color: "#673ab7" },
        // { id: 27, title: "UK Legal and Administrative Procedures", description: "Buyuk Britaniya qonuniy va ma'muriy protseduralar", file: "Chapter_27_Legal_Procedures.html", color: "#3f51b5" },
        // { id: 28, title: "Complex Healthcare Interactions", description: "Murakkab tibbiy muloqot", file: "Chapter_28_Healthcare_Advanced.html", color: "#2196f3" },
        // { id: 29, title: "Professional Development", description: "Kasbiy rivojlanish", file: "Chapter_29_Professional_Development.html", color: "#00bcd4" },
        // { id: 30, title: "Housing Rights and Responsibilities", description: "Uy-joy huquqlari va majburiyatlari", file: "Chapter_30_Housing_Rights.html", color: "#009688" },
        // { id: 31, title: "Digital Services and Online Applications", description: "Raqamli xizmatlar va onlayn ilovalar", file: "Chapter_31_Digital_Services.html", color: "#4caf50" },
        // { id: 32, title: "Advanced Grammar and Writing", description: "Ilg'or grammatika va yozish", file: "Chapter_32_Advanced_Grammar.html", color: "#8bc34a" },
        // { id: 33, title: "Cultural Integration and Social Skills", description: "Madaniy integratsiya va ijtimoiy ko'nikmalar", file: "Chapter_33_Cultural_Integration.html", color: "#cddc39" },
        // { id: 34, title: "Career Advancement Strategies", description: "Martaba rivojlantirish strategiyalari", file: "Chapter_34_Career_Advancement.html", color: "#ffeb3b" },
        // { id: 35, title: "A2 Completion and B1 Preparation", description: "A2 yakunlash va B1 tayyorgarlik", file: "Chapter_35_A2_Completion.html", color: "#ff9800" },
        // { id: 'a2-completion', title: "A2 Course Completion", description: "A2 kurs yakunlandi", file: "a2-course-completion.html", type: 'completion', color: "#ff5722" }
        //
        const chapters = [
            { id: 0, title: "Foundations: Alphabet & Numbers", description: "Asos: Alifbo va raqamlar", file: "Chapter_0_Foundations_Alphabet_Numbers.html", color: "#2c3e50" },
            { id: 1, title: "Greetings, Personal Info", description: "Salomlashish va shaxsiy ma'lumotlar", file: "English_for_Uzbek_Seasonal_Workers.html", color: "#3498db" },
            { id: 2, title: "Time, Calendar", description: "Vaqt va kalendar", file: "Chapter_2_Numbers_Time.html", color: "#27ae60" },
            { id: 3, title: "Everyday Objects and Colours", description: "Kundalik buyumlar va ranglar", file: "Chapter_3_Objects_Colours.html", color: "#9b59b6" },
            { id: 4, title: "Basic Actions and Everyday Verbs", description: "Asosiy harakatlar va kundalik fe'llar", file: "Chapter_4_Basic_Verbs.html", color: "#f39c12" },
            { id: 5, title: "Description: Adjectives and Adverbs", description: "Tavsif: sifat va ravishlar", file: "Chapter_5_Adjectives_Adverbs.html", color: "#e74c3c" },
            { id: 6, title: "Accommodation and Furniture", description: "Turar joy va mebel", file: "Chapter_6_Accommodation_Furniture.html", color: "#16a085" },
            { id: 7, title: "Transportation and Travel", description: "Transport va sayohat", file: "Chapter_7_Transportation_Travel.html", color: "#8e44ad" },
            { id: 8, title: "Places in Town and Navigation", description: "Shahardagi joylar va yo'l topish", file: "Chapter_8_Places_Navigation.html", color: "#2ecc71" },
            { id: 9, title: "Shopping and Transactions", description: "Xarid qilish va to'lovlar", file: "Chapter_9_Shopping_Transactions.html", color: "#e67e22" },
            { id: 10, title: "Clothing and Weather", description: "Kiyim va ob-havo", file: "Chapter_10_Clothing_Weather.html", color: "#9c27b0" },
            { id: 11, title: "Food, Cooking, and Ordering", description: "Ovqat, pishirish va buyurtma berish", file: "Chapter_11_Food_Cooking_Ordering.html", color: "#1abc9c" },
            { id: 12, title: "Health and Medical Procedures", description: "Sog'liq va tibbiy protseduralar", file: "Chapter_12_Health_Medical.html", color: "#34495e" },
            { id: 13, title: "Farm Work: Tasks and Safety", description: "Ferma ishi: vazifalar va xavfsizlik", file: "Chapter_13_Farm_Work_Tasks.html", color: "#2980b9" },
            { id: 14, title: "Employer Communication: Instructions", description: "Ish beruvchi bilan muloqot: ko'rsatmalar", file: "Chapter_14_Employer_Instructions.html", color: "#2c3e50" },
            { id: 15, title: "Requests and Permissions", description: "So'rovlar va ruxsatlar", file: "Chapter_15_Requests_Permissions.html", color: "#d35400" },
            { id: 16, title: "Banking and Money Management", description: "Bank ishlari va pul boshqaruvi", file: "Chapter_16_Banking_Finance.html", color: "#bdc3c7" },
            { id: 17, title: "Emergency Situations and Safety", description: "Favqulodda vaziyatlar va xavfsizlik", file: "Chapter_17_Emergency_Safety.html", color: "#c0392b" },
            { id: 18, title: "Core Communication Skills", description: "Asosiy muloqot ko'nikmalari", file: "Chapter_18_Communication_Skills.html", color: "#7f8c8d" },
            { id: 19, title: "Countries, Nationalities, Languages", description: "Mamlakatlar, milliyatlar, tillar", file: "Chapter_19_Countries_Languages.html", color: "#f1c40f" },
            { id: 20, title: "Free Time and Social Life", description: "Bo'sh vaqt va ijtimoiy hayot", file: "Chapter_20_Free_Time_Social.html", color: "#3498db" },
            { id: 21, title: "Sports and Activities", description: "Sport va faoliyatlar", file: "Chapter_21_Sports_Activities.html", color: "#27ae60" },
            { id: 22, title: "Family and Relationships", description: "Oila va munosabatlar", file: "Chapter_22_Family_Relations.html", color: "#9b59b6" },
            { id: 23, title: "Writing and Filling Out Forms", description: "Yozish va shakllarni to'ldirish", file: "Chapter_23_Writing_Forms.html", color: "#f39c12" },
            { id: 24, title: "Jobs, Future Plans, and Review", description: "Ishlar, kelajak rejalari va takrorlash", file: "Chapter_24_Jobs_Future_Review.html", color: "#e74c3c" },
            { id: 'completion', title: "Course Completion", description: "Kurs yakunlandi", file: "course-completion.html", type: 'completion', color: "#4caf50" },
            { id: 'a2-preview', title: "Next Level: A2 Course", description: "Keyingi bosqich: A2 darajasi", file: "#", type: 'a2-preview', color: "#ff9800" }
        ];

        // Render chapters without progress tracking (fallback)
        function renderChaptersWithoutProgress() {
            const grid = document.querySelector('.chapters-grid');
            
            chapters.forEach(chapter => {
                // Skip special cards for now
                if (chapter.type === 'completion' || chapter.type === 'a2-preview') {
                    return;
                }

                const card = document.createElement('a');
                card.className = 'chapter-card';
                card.href = chapter.file;
                card.style.setProperty('--chapter-color', chapter.color);
                card.setAttribute('data-chapter-id', chapter.id);
                card.setAttribute('role', 'link');
                card.setAttribute('aria-label', `Chapter ${chapter.id}: ${chapter.title}. ${chapter.description}`);
                card.setAttribute('tabindex', '0');

                card.innerHTML = `
                    <div>
                        <div class="chapter-number" aria-hidden="true">Chapter ${chapter.id}</div>
                        <div class="chapter-title" aria-hidden="true">${chapter.title}</div>
                        <div class="chapter-description" aria-hidden="true">${chapter.description}</div>
                    </div>
                    <div class="chapter-progress">
                        <div class="chapter-progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="Chapter ${chapter.id} progress: 0% complete">
                            <div class="chapter-progress-fill" style="width: 0%; background: ${chapter.color};"></div>
                        </div>
                        <div class="chapter-status-icon not-started" aria-label="Chapter status: not started">0%</div>
                    </div>
                `;

                grid.appendChild(card);
            });
        }

        // Render chapters
        function renderChapters() {
            const grid = document.querySelector('.chapters-grid');
            const progressData = ProgressTracker.getProgress();

            // Clear existing content except screen reader elements
            const srElements = grid.querySelectorAll('.sr-only');
            grid.innerHTML = '';
            srElements.forEach(el => grid.appendChild(el));

            chapters.forEach(chapter => {
                // Check if this is a completion card
                if (chapter.type === 'completion') {
                    renderCompletionCard(chapter, grid, progressData);
                    return;
                }

                // Check if this is A2 preview card
                if (chapter.type === 'a2-preview') {
                    renderA2PreviewCard(chapter, grid);
                    return;
                }

                const chapterProgress = progressData.chapters[chapter.id] || { completed: 0, total: 10 };
                const progressPercent = Math.round((chapterProgress.completed / chapterProgress.total) * 100);

                // Determine status
                let statusClass = 'not-started';
                let statusIcon = '';
                if (progressPercent === 100) {
                    statusClass = 'completed';
                    statusIcon = '✓';
                } else if (progressPercent > 0) {
                    statusClass = 'in-progress';
                    statusIcon = progressPercent + '%';
                }

                const card = document.createElement('a');
                card.className = 'chapter-card';
                card.href = chapter.file;
                card.style.setProperty('--chapter-color', chapter.color);
                card.setAttribute('data-chapter-id', chapter.id);

                // Add ARIA attributes for accessibility
                card.setAttribute('role', 'link');
                card.setAttribute('aria-label', `Chapter ${chapter.id}: ${chapter.title}. Progress: ${progressPercent}% completed. ${chapter.description}`);
                card.setAttribute('tabindex', '0');

                // Add heading for screen readers
                const chapterHeading = document.createElement('h3');
                chapterHeading.className = 'sr-only';
                chapterHeading.textContent = `Chapter ${chapter.id}: ${chapter.title}`;
                card.appendChild(chapterHeading);

                // Add exercise completion indicators
                const exerciseIndicators = chapterProgress.exercises.map((completed, index) =>
                    `<span class="exercise-indicator ${completed ? 'completed' : 'not-completed'}" 
                           title="Exercise ${index + 1}: ${completed ? 'Completed' : 'Not completed'}"></span>`
                ).join('');

                card.innerHTML = `
                    <div>
                        <div class="chapter-number" aria-hidden="true">Chapter ${chapter.id}</div>
                        <div class="chapter-title" aria-hidden="true">${chapter.title}</div>
                        <div class="chapter-description" aria-hidden="true">${chapter.description}</div>
                        <div class="exercise-indicators" role="group" aria-label="Exercise completion indicators">
                            ${exerciseIndicators}
                        </div>
                    </div>
                    <div class="chapter-progress">
                        <div class="chapter-progress-bar" role="progressbar" aria-valuenow="${progressPercent}" aria-valuemin="0" aria-valuemax="100" aria-label="Chapter ${chapter.id} progress: ${progressPercent}% complete">
                            <div class="chapter-progress-fill" style="width: ${progressPercent}%; background: ${chapter.color};"></div>
                        </div>
                        <div class="chapter-status-icon ${statusClass}" aria-label="Chapter status: ${statusClass.replace('-', ' ')}">${statusIcon}</div>
                    </div>
                `;

                grid.appendChild(card);
            });
        }

        // Render completion card
        function renderCompletionCard(chapter, grid, progressData) {
            // Calculate statistics from progress data
            let totalExercisesCompleted = 0;
            let totalChaptersCompleted = 0;
            const totalChapters = 25; // Including Chapter 0
            const totalExercises = 250; // 25 chapters × 10 exercises each

            // Calculate completed exercises and chapters
            Object.keys(progressData.chapters).forEach(chapterId => {
                const chapterProgress = progressData.chapters[chapterId];
                if (chapterProgress) {
                    totalExercisesCompleted += chapterProgress.completed || 0;
                    if (chapterProgress.completed === chapterProgress.total) {
                        totalChaptersCompleted++;
                    }
                }
            });

            // Calculate overall completion percentage
            const overallProgress = Math.round((totalExercisesCompleted / totalExercises) * 100);

            // Create clickable card like regular chapters
            const card = document.createElement('a');
            card.className = 'chapter-card completion-card';
            card.href = chapter.file;
            card.style.setProperty('--chapter-color', chapter.color);
            card.setAttribute('data-chapter-id', chapter.id);
            card.setAttribute('role', 'link');
            card.setAttribute('aria-label', `Course Completion: ${overallProgress}% complete. ${totalChaptersCompleted} chapters and ${totalExercisesCompleted} exercises completed.`);
            card.setAttribute('tabindex', '0');

            // Add semantic heading structure for screen readers
            const chapterHeading = document.createElement('h3');
            chapterHeading.className = 'sr-only';
            chapterHeading.textContent = `Course Completion: ${chapter.title}`;
            chapterHeading.id = 'completion-card-heading';
            card.appendChild(chapterHeading);

            // Add landmark role
            card.setAttribute('role', 'link');
            card.setAttribute('aria-labelledby', 'completion-card-heading');

            card.innerHTML = `
                <div role="region" aria-labelledby="completion-title" aria-describedby="completion-summary">
                    <div class="chapter-number" aria-hidden="true">🎉 Completion</div>
                    <div class="chapter-title" aria-hidden="true" id="completion-title">${chapter.title}</div>
                    <div class="chapter-description" aria-hidden="true">${chapter.description}</div>
                    <div class="completion-summary" id="completion-summary" 
                         style="margin-top: 8px; font-size: 0.75rem; color: rgba(255,255,255,0.9);"
                         aria-label="Course statistics: ${totalChaptersCompleted} out of 25 chapters completed, ${totalExercisesCompleted} out of 250 exercises completed, 720 vocabulary words learned">
                        ${totalChaptersCompleted}/25 chapters • ${totalExercisesCompleted}/250 exercises • 720 words
                    </div>
                </div>
                <div class="chapter-progress" role="group" aria-label="Course completion progress">
                    <div class="chapter-progress-bar" role="progressbar" 
                         aria-valuenow="${overallProgress}" 
                         aria-valuemin="0" 
                         aria-valuemax="100" 
                         aria-label="Overall course progress: ${overallProgress}% complete"
                         aria-describedby="progress-description">
                        <div class="chapter-progress-fill" style="width: ${overallProgress}%; background: ${chapter.color};"></div>
                    </div>
                    <div class="chapter-status-icon completed" 
                         aria-label="Course completion percentage: ${overallProgress}%"
                         role="status">${overallProgress}%</div>
                    <div id="progress-description" class="sr-only">
                        Course completion progress bar showing ${overallProgress}% completion based on ${totalExercisesCompleted} completed exercises out of 250 total exercises across 25 chapters.
                    </div>
                </div>
            `;

            grid.appendChild(card);

        }

        // Render A2 Level Preview Card
        // 
        // EXTENSION POINT: A2 Level Integration
        // This function creates a preview card for the A2 level course.
        // 
        // To implement full A2 level support:
        // 1. Replace this placeholder with actual A2 chapters in the chapters array
        // 2. Create A2 chapter files (Chapter_26_*.html through Chapter_35_*.html)
        // 3. Update ProgressTracker.js to handle A2 progress (chapters 26-35)
        // 4. Create a2-course-completion.html for A2 completion
        // 5. Update certificate-generator.js to support A2 certificates
        // 
        // Data structure for A2 progress tracking:
        // progressData.a2Chapters = {
        //     26: { completed: 0, total: 10, exercises: [false, false, ...] },
        //     27: { completed: 0, total: 10, exercises: [false, false, ...] },
        //     // ... chapters 28-35
        // }
        //
        function renderA2PreviewCard(chapter, grid) {
            const a2Card = document.createElement('div');
            a2Card.className = 'chapter-card future-content-placeholder';
            a2Card.style.setProperty('--chapter-color', chapter.color);
            a2Card.setAttribute('data-chapter-id', chapter.id);
            a2Card.setAttribute('role', 'region');
            a2Card.setAttribute('aria-label', 'A2 level course preview - coming soon');
            a2Card.setAttribute('tabindex', '0');

            a2Card.innerHTML = `
                <div>
                    <div class="chapter-number" aria-hidden="true">🚀 A2 Level</div>
                    <div class="chapter-title" aria-hidden="true">${chapter.title}</div>
                    <div class="chapter-description" aria-hidden="true">${chapter.description}</div>
                    <div class="a2-preview-content" style="margin-top: 12px; font-size: 0.75rem; opacity: 0.9;">
                        Advanced topics • Professional development • Coming 2024
                    </div>
                </div>
                <div class="chapter-progress">
                    <div class="a2-status" style="text-align: center; padding: 8px; background: rgba(255, 152, 0, 0.2); border-radius: 8px; font-size: 0.75rem; font-weight: 500;">
                        Tez orada / Coming Soon
                    </div>
                </div>
            `;

            // Add click handler for A2 preview
            a2Card.addEventListener('click', function() {
                announceToScreenReader('A2 level course is coming soon. More advanced English topics will be available by the end of 2024.');
            });

            // Add keyboard support
            a2Card.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    announceToScreenReader('A2 level course preview. Advanced English course coming soon with professional development topics.');
                }
            });

            grid.appendChild(a2Card);
        }

        // Update completion card when progress changes
        function updateCompletionCard() {
            const completionCard = document.querySelector('[data-chapter-id="completion"]');
            if (completionCard && typeof ProgressTracker !== 'undefined') {
                const progressData = ProgressTracker.getProgress();
                
                // Recalculate statistics
                let totalExercisesCompleted = 0;
                let totalChaptersCompleted = 0;
                const totalExercises = 250;

                Object.keys(progressData.chapters).forEach(chapterId => {
                    const chapterProgress = progressData.chapters[chapterId];
                    if (chapterProgress) {
                        totalExercisesCompleted += chapterProgress.completed || 0;
                        if (chapterProgress.completed === chapterProgress.total) {
                            totalChaptersCompleted++;
                        }
                    }
                });

                const overallProgress = Math.round((totalExercisesCompleted / totalExercises) * 100);

                // Update completion summary with ARIA
                const summaryElement = completionCard.querySelector('.completion-summary');
                if (summaryElement) {
                    summaryElement.textContent = `${totalChaptersCompleted}/25 chapters • ${totalExercisesCompleted}/250 exercises • 720 words`;
                    summaryElement.setAttribute('aria-label', `Course statistics: ${totalChaptersCompleted} out of 25 chapters completed, ${totalExercisesCompleted} out of 250 exercises completed, 720 vocabulary words learned`);
                }

                // Update progress bar with animation and ARIA
                const progressBar = completionCard.querySelector('.chapter-progress-bar');
                const progressFill = completionCard.querySelector('.chapter-progress-fill');
                const statusIcon = completionCard.querySelector('.chapter-status-icon');
                const progressDescription = completionCard.querySelector('#progress-description');
                
                if (progressBar && progressFill && statusIcon) {
                    // Update ARIA attributes
                    progressBar.setAttribute('aria-valuenow', overallProgress);
                    progressBar.setAttribute('aria-label', `Overall course progress: ${overallProgress}% complete`);
                    statusIcon.setAttribute('aria-label', `Course completion percentage: ${overallProgress}%`);
                    
                    if (progressDescription) {
                        progressDescription.textContent = `Course completion progress bar showing ${overallProgress}% completion based on ${totalExercisesCompleted} completed exercises out of 250 total exercises across 25 chapters.`;
                    }
                    
                    // Add transition for smooth animation
                    progressFill.style.transition = 'width 0.8s cubic-bezier(0.4, 0.0, 0.2, 1)';
                    progressFill.style.width = overallProgress + '%';
                    statusIcon.textContent = overallProgress + '%';
                    
                    // Add completion celebration effect if 100%
                    if (overallProgress === 100) {
                        progressFill.style.boxShadow = '0 0 20px rgba(76, 175, 80, 0.8)';
                        statusIcon.classList.add('completed');
                        statusIcon.innerHTML = '🎉';
                        statusIcon.setAttribute('aria-label', 'Course completed! 100% progress achieved');
                        
                        // Announce completion to screen readers
                        announceToScreenReader('Congratulations! You have completed the entire English course with 100% progress!', 'assertive');
                    }
                }

                // Update main ARIA label
                completionCard.setAttribute('aria-label', `Course Completion: ${overallProgress}% complete. ${totalChaptersCompleted} chapters and ${totalExercisesCompleted} exercises completed. Click to view detailed completion information.`);
            }
        }

        // Basic completion card rendering - simple structure like in image
        function renderBasicCompletionCard(chapter, grid) {
            const completionCard = document.createElement('a');
            completionCard.className = 'chapter-card';
            completionCard.href = chapter.file;
            completionCard.style.setProperty('--chapter-color', chapter.color);
            completionCard.style.background = `linear-gradient(135deg, ${chapter.color} 0%, #2e7d32 100%)`;
            completionCard.style.color = 'white';
            completionCard.style.border = 'none';
            completionCard.setAttribute('data-chapter-id', chapter.id);
            completionCard.setAttribute('aria-label', `${chapter.title}: ${chapter.description}. Click to view course completion and certificate information.`);
            
            completionCard.innerHTML = `
                <div>
                    <div class="chapter-number" style="color: rgba(255,255,255,0.8);">🎓 Final</div>
                    <div class="chapter-title" style="color: white; font-size: 1.2rem; font-weight: 600; margin-bottom: 8px;">${chapter.title}</div>
                    <div class="chapter-description" style="color: rgba(255,255,255,0.9); margin-bottom: 20px;">${chapter.description}</div>
                </div>
                <div style="display: flex; align-items: center; justify-content: space-between;">
                    <div style="flex: 1; height: 6px; background: rgba(255,255,255,0.3); border-radius: 3px; margin-right: 12px;">
                        <div style="width: 100%; height: 100%; background: white; border-radius: 3px;"></div>
                    </div>
                    <div style="width: 24px; height: 24px; background: rgba(255,255,255,0.9); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #2e7d32; font-weight: bold;">✓</div>
                </div>
            `;
            
            grid.appendChild(completionCard);
        }

        // Basic A2 preview card rendering - simple structure like in image
        function renderBasicA2PreviewCard(chapter, grid) {
            const a2Card = document.createElement('div');
            a2Card.className = 'chapter-card';
            a2Card.style.setProperty('--chapter-color', chapter.color);
            a2Card.style.background = `linear-gradient(135deg, ${chapter.color} 0%, #f57c00 100%)`;
            a2Card.style.color = 'white';
            a2Card.style.border = 'none';
            a2Card.style.cursor = 'pointer';
            a2Card.setAttribute('data-chapter-id', chapter.id);
            a2Card.setAttribute('role', 'button');
            a2Card.setAttribute('tabindex', '0');
            a2Card.setAttribute('aria-label', 'A2 level course preview. Advanced English course coming soon with professional development topics.');
            
            a2Card.innerHTML = `
                <div>
                    <div class="chapter-number" style="color: rgba(255,255,255,0.8);">🚀 Soon</div>
                    <div class="chapter-title" style="color: white; font-size: 1.2rem; font-weight: 600; margin-bottom: 8px;">${chapter.title}</div>
                    <div class="chapter-description" style="color: rgba(255,255,255,0.9); margin-bottom: 20px;">${chapter.description} - tez orada</div>
                </div>
                <div style="display: flex; align-items: center; justify-content: flex-end;">
                    <div style="width: 32px; height: 32px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 16px;">🚀</div>
                </div>
            `;
            
            // Add click and keyboard handlers
            function handleA2Click() {
                alert('A2 level course is coming soon! More advanced English topics will be available by the end of 2024.');
            }
            
            a2Card.addEventListener('click', handleA2Click);
            a2Card.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    handleA2Click();
                }
            });
            
            grid.appendChild(a2Card);
        }

        // Simple and reliable chapter rendering
        function renderBasicChapters() {
            console.log('Rendering basic chapters...');
            const grid = document.querySelector('.chapters-grid');
            
            if (!grid) {
                console.error('Grid element not found!');
                return;
            }
            
            // Clear any existing content except screen reader elements
            const srElements = grid.querySelectorAll('.sr-only');
            grid.innerHTML = '';
            srElements.forEach(el => grid.appendChild(el));
            
            chapters.forEach(chapter => {
                // Handle special cards
                if (chapter.type === 'completion') {
                    renderBasicCompletionCard(chapter, grid);
                    return;
                }
                
                if (chapter.type === 'a2-preview') {
                    renderBasicA2PreviewCard(chapter, grid);
                    return;
                }
                
                // Regular chapter cards
                const card = document.createElement('a');
                card.className = 'chapter-card';
                card.href = chapter.file;
                card.style.setProperty('--chapter-color', chapter.color);
                card.setAttribute('data-chapter-id', chapter.id);
                
                card.innerHTML = `
                    <div>
                        <div class="chapter-number">Chapter ${chapter.id}</div>
                        <div class="chapter-title">${chapter.title}</div>
                        <div class="chapter-description">${chapter.description}</div>
                    </div>
                    <div class="chapter-progress">
                        <div class="chapter-progress-bar">
                            <div class="chapter-progress-fill" style="width: 0%; background: ${chapter.color};"></div>
                        </div>
                        <div class="chapter-status-icon not-started">0%</div>
                    </div>
                `;
                
                grid.appendChild(card);
            });
            
            console.log('Basic chapters rendered successfully');
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function () {
            console.log('DOM loaded, initializing chapters...');
            
            // Try to render with progress tracking first, fallback to basic if needed
            if (typeof ProgressTracker !== 'undefined') {
                console.log('ProgressTracker available, rendering with progress...');
                try {
                    renderChapters();
                } catch (error) {
                    console.error('Error rendering with progress:', error);
                    console.log('Falling back to basic rendering...');
                    renderBasicChapters();
                }
            } else {
                console.log('ProgressTracker not available, using basic rendering');
                renderBasicChapters();
            }

            // Set up progress update listener
            if (typeof ProgressTracker.onProgressUpdate === 'function') {
                ProgressTracker.onProgressUpdate(updateCompletionCard);
            }

            // Detect keyboard navigation
            document.addEventListener('keydown', function (e) {
                if (e.key === 'Tab') {
                    document.body.classList.add('keyboard-user');
                }
            });

            // Detect mouse usage
            document.addEventListener('mousedown', function () {
                document.body.classList.remove('keyboard-user');
            });

            // Handle keyboard navigation for chapter cards
            document.addEventListener('keydown', function (e) {
                if (e.target.classList.contains('chapter-card')) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        const ariaLabel = e.target.getAttribute('aria-label');
                        announceToScreenReader(`Navigating to ${ariaLabel}`);
                        
                        // Special handling for completion card
                        if (e.target.getAttribute('data-chapter-id') === 'completion') {
                            announceToScreenReader('Opening course completion page with detailed results and certificate options', 'assertive');
                        }
                        
                        window.location.href = e.target.href;
                    }
                }
            });



            // Initialize screen reader announcements
            initializeScreenReaderSupport();

            // Fallback: ensure chapters are rendered after a short delay
            setTimeout(() => {
                const grid = document.querySelector('.chapters-grid');
                if (grid && grid.children.length <= 1) { // Only h2.sr-only should be there
                    console.log('No chapters rendered, using fallback...');
                    renderChaptersWithoutProgress();
                }
            }, 1000);
        });

        // Initialize screen reader support
        function initializeScreenReaderSupport() {
            // Announce page load completion
            setTimeout(() => {
                announceToScreenReader('English for Uzbek Seasonal Workers textbook loaded. Use Tab to navigate between chapters.');
            }, 1000);

            // Add focus announcements for chapter cards
            document.addEventListener('focus', function (e) {
                if (e.target.classList.contains('chapter-card')) {
                    const chapterInfo = e.target.getAttribute('aria-label');
                    announceToScreenReader(`Focused on ${chapterInfo}. Press Enter or Space to open chapter.`);
                }
            }, true);


        }

        // Announce message to screen readers
        function announceToScreenReader(message, priority = 'polite') {
            const liveRegionId = priority === 'assertive' ? 'aria-live-assertive' : 'aria-live-region';
            const liveRegion = document.getElementById(liveRegionId);

            if (liveRegion) {
                // Clear previous message
                liveRegion.textContent = '';

                // Add new message after a brief delay to ensure it's announced
                setTimeout(() => {
                    liveRegion.textContent = message;
                }, 100);

                // Clear after announcement to avoid repetition
                setTimeout(() => {
                    liveRegion.textContent = '';
                }, 3000);
            }
        }



        // Offline detection
        window.addEventListener('online', function () {
            document.body.classList.remove('offline-mode');
            announceToScreenReader('Internet connection restored');
        });

        window.addEventListener('offline', function () {
            document.body.classList.add('offline-mode');
            announceToScreenReader('Working in offline mode');
        });

        // Performance monitoring
        if ('performance' in window) {
            window.addEventListener('load', function () {
                setTimeout(() => {
                    const perfData = performance.getEntriesByType('navigation')[0];
                    if (perfData) {
                        const loadTime = perfData.loadEventEnd - perfData.loadEventStart;
                        console.log(`Page load time: ${loadTime}ms`);

                        // Report slow loading
                        if (loadTime > 3000) {
                            console.warn('Page loaded slowly. Consider optimizations.');
                        }
                    }
                }, 0);
            });
        }
    </script>
    <script src="certificate-generator.js"></script>
    <script src="telegram-web-app.js"></script>
</body>

</html>
